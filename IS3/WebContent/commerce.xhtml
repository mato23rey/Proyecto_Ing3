<html xmlns="http://www.w3c.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<h:head>
	<title>Farmacia Ya</title>
</h:head>
<h:body>

	<h:outputStylesheet library="css" name="index.css" />
	<h:outputScript library="js" name="cart.js" />
	<h:outputScript library="js" name="index.js" />

	<ui:insert name="header">
		<ui:include src="header.xhtml" />
	</ui:insert>

	<p:panel>
		<div class="ui-grid ui-grid-responsive">
			<div class="ui-grid-row">
				<div class="ui-grid-col-2">
					<p:graphicImage
						value="http://www.brandsoftheworld.com/sites/default/files/styles/logo-thumbnail/public/112011/logo_farmashop_vertical_diapo.png"
						height="128" width="128" />
				</div>
				<div class="ui-grid-col-4">
					<p:outputPanel>
						<h:panelGrid columns="2" cellpadding="2">
							<h:outputText value="Nombre:" />
							<h:outputText
								value="#{commerceBean.sucursal.pharmacyName} #{commercceBean.sucursal.sucursalName}"
								style="font-weight: bold" />

							<h:outputText value="Direccion:" />
							<h:outputText value="#{commerceBean.sucursal.address}"
								style="font-weight: bold" />

							<h:outputText value="Calificacion:" />
							<p:rating value="#{commerceBean.sucursal.score}" readonly="true" />
						</h:panelGrid>
					</p:outputPanel>
				</div>

			</div>
		</div>
	</p:panel>

	<div class="ui-grid ui-grid-responsive">
		<div class="ui-grid-row">
			<div class="ui-grid-col-8">
				<p:dataScroller value="#{commerceBean.result}" var="result"
					chunkSize="10">
					<f:facet name="header">
           			Productos
       			</f:facet>
					<p:panel>
						<div class="ui-grid ui-grid-responsive">
							<div class="ui-grid-row">
								<div class="ui-grid-col-3">
									<p:graphicImage
										value="http://mlu-s1-p.mlstatic.com/perifar-400-espasmo-flex-15849-MLU20110476806_062014-O.jpg"
										height="128" width="128" />
								</div>

								<div class="ui-grid-col-6">
									<p:outputPanel>
										<h:panelGrid columns="2" cellpadding="2">
											<h:outputText value="Nombre:" />
											<h:outputText value="#{result.name}"
												style="font-weight: bold" />

											<h:outputText value="Precio:" />
											<h:outputText value="$#{result.price}"
												style="font-weight: bold" />

											<h:outputText value="Descripcion:" />
											<h:outputText value="#{result.desc}"
												style="font-weight: bold" />
										</h:panelGrid>
									</p:outputPanel>
								</div>


								<div class="ui-grid-col-3 textCenter">
									<p:commandButton value="Adquirir" icon="ui-icon-plusthick"
										styleClass="ui-priority-primary"
										onclick="PF('#{result.name}Dialog').show();">

										<f:attribute name="item" value="#{result}" />
									</p:commandButton>
								</div>


								<p:dialog header="Seleccionar cantidad"
									widgetVar="#{result.name}Dialog" resizable="false"
									id='#{result.name}Dialog'>
									<h:form styleClass="textCenter">
										<p:growl id="growl" sticky="true" showDetail="true" life="100" />
										<h:outputLabel for="cant" value="Cantidad:" />
										<p:inputText id="cant" required="true"
											requiredMessage="Debes ingresar la cantidad!" type="number"
											validatorMessage="Cantidad invalida" value="#{cartBean.cant}"
											autofocus="true" onfocus="this.value = this.value;">
											<f:validateLongRange minimum="1" maximum="100" />
										</p:inputText>

										<br></br>
										<br></br>

										<p:commandButton actionListener="#{cartBean.addItem}"
											value="Confirmar" styleClass="ui-priority-primary"
											oncomplete="onNewItem(xhr, status, args)" update="growl">

											<f:attribute name="item" value="#{result}" />
										</p:commandButton>
									</h:form>
								</p:dialog>

							</div>
						</div>

					</p:panel>
				</p:dataScroller>
			</div>


			<div class="ui-grid-col-4">
				<p:dataScroller value="#{cartBean.cart}" var="cart" chunkSize="10">
					<f:facet name="header">
           			Mi pedido
       			</f:facet>
					<p:panel>
						<div class="ui-grid ui-grid-responsive">
							<div class="ui-grid-row">
								<div class="ui-grid-col-6">
									<p:outputPanel>
										<h:panelGrid columns="2" cellpadding="2">
											<h:outputText value="Nombre:" />
											<h:outputText value="#{cart.productName}"
												style="font-weight: bold" />

											<h:outputText value="Precio:" />
											<h:outputText value="$#{cart.productPrice}"
												style="font-weight: bold" />

											<h:outputText value="Cantidad:" />
											<h:outputText value="#{cart.cant}" style="font-weight: bold" />

											<h:outputText value="Total" />
											<h:outputText value="$#{cart.total}"
												style="font-weight: bold" />
										</h:panelGrid>
									</p:outputPanel>
								</div>

								<div class="ui-grid-col-6 textCenter">
									<p:commandButton actionListener="#{cartBean.removeItem}"
										value="Eliminar" icon="ui-icon-closethick"
										oncomplete="location.reload()">
										<f:attribute name="item" value="#{cart}" />
									</p:commandButton>
								</div>
							</div>
						</div>

					</p:panel>

				</p:dataScroller>
				<p:panel styleClass="textCenter">
					<h:outputText value="Total: " />
					<h:outputText value="$#{cartBean.total}" style="font-weight: bold" />
					<f:facet name="footer">
						<div class="ui-grid ui-grid-responsive textCenter">
							<div class="ui-grid-row">
								<div class="ui-grid-col-6">
									<p:commandButton value='Pedir' icon="ui-icon-circle-check"
										actionListener="#{cartBean.requestOrder}"
										oncomplete="onRequested(xhr, status, args)">
										<f:attribute name="logued" value="#{loginBean.logued}" />
									</p:commandButton>
								</div>
								<div class="ui-grid-col-6">
									<p:commandButton value='Cancelar' icon="ui-icon-circle-close"
										actionListener="#{cartBean.cancelOrder}"
										oncomplete="location.reload()" />
								</div>
							</div>
						</div>

					</f:facet>
				</p:panel>
				<div id='orderMessages'></div>
				<p:messages for="orderMessages" showDetail="true" autoUpdate="true"
					closable="true" />
			</div>
		</div>
	</div>

	<f:metadata>
		<f:viewParam name="comId" value="#{commerceBean.comId}" />
	</f:metadata>

</h:body>

</html>